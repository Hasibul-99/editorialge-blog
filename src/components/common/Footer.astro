---
import { Image } from "astro:assets";
import Logo from "@/assets/img/logo/logo.png";
import WLogo from "@/assets/img/logo/w_logo.png";
import { categoryListWithRelation } from "@/scripts/graphql-query";

const locale = Astro.url.pathname.startsWith('/bn') ? 'bn' : 'en';
const response = await fetch(`${import.meta.env.PUBLIC_BASEURL}/graphql`, {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    query: categoryListWithRelation(locale),
  }),
});
const json = await response.json();
const categories = json?.data?.categories ?? [];
const companyCats = categories.slice(0, 4);
const exploreCats = categories.slice(4, 9);
const currentYear = new Date().getFullYear();
const basePath = locale === 'bn' ? '/bn' : '';
---

<div>
  <footer>
    <div class="footer-area-four">
      <div class="footer-top footer-top-three">
        <div class="container">
          <div class="row">
            <div class="col-lg-3 col-md-7">
              <div class="footer-widget">
                <div class="fw-logo">
                  <a href={basePath || "/"}>
                    <Image src={Logo} alt="" />
                  </a>
                </div>
                <div class="fw-logo d-none">
                  <a href={basePath || "/"}>
                    <Image src={WLogo} alt="" />
                  </a>
                </div>
                <div class="footer-content">
                  <p>
                    Browned butter and brown sugar caramelly goodness, crispy
                    edges thick and soft centers and melty little puddles of
                    chocolate.
                  </p>
                </div>
              </div>
            </div>
            <div class="col-lg-2 col-md-5 col-sm-6">
              <div class="footer-widget">
                <h4 class="fw-title">Company</h4>
                <div class="footer-link-wrap">
                  <ul class="list-wrap">
                    {companyCats?.length ? (
                      companyCats.map((cat: any) => (
                        <li><a href={`${basePath}/category/${cat.slug}`}>{cat.title}</a></li>
                      ))
                    ) : (
                      <li><a href="/contact">Contact</a></li>
                    )}
                  </ul>
                </div>
              </div>
            </div>
            <div class="col-lg-3 col-md-4 col-sm-6">
              <div class="footer-widget">
                <h4 class="fw-title">Get Help</h4>
                <div class="footer-link-wrap">
                  <ul class="list-wrap">
                    <li><a href="/contact">Contact & Faq</a></li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="col-lg-2 col-md-4 col-sm-6">
              <div class="footer-widget">
                <h4 class="fw-title">Explore</h4>
                <div class="footer-link-wrap">
                  <ul class="list-wrap">
                    {exploreCats?.length ? (
                      exploreCats.map((cat: any) => (
                        <li><a href={`${basePath}/category/${cat.slug}`}>{cat.title}</a></li>
                      ))
                    ) : null}
                  </ul>
                </div>
              </div>
            </div>
            <div class="col-lg-2 col-md-4 col-sm-6">
              <div class="footer-widget">
                <h4 class="fw-title">Follow us On</h4>
                <div class="footer-link-wrap">
                  <ul class="list-wrap">
                    <li><a href="#">facebook</a></li>
                    <li><a href="#">Twitter</a></li>
                    <li><a href="#">Instagram</a></li>
                    <li><a href="#">Youtube</a></li>
                    <li><a href="#">Pinterest</a></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="footer-bottom footer-bottom-three">
        <div class="container">
          <div class="row">
            <div class="col-md-6">
              <div class="footer-bottom-menu">
                <ul class="list-wrap">
                  <li><a href="/contact">Privacy Policy & Terms</a></li>
                  <li><a href="/contact">Site Credits</a></li>
                </ul>
              </div>
            </div>
            <div class="col-md-6">
              <div class="copyright-text">
                <p>Â© {currentYear} All Rights Reserved</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer>
</div>
